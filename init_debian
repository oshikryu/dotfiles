#!/bin/bash
curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

sudo yum update
sudo yum install zsh

# for amazon linux
sudo chsh -s /bin/zsh ec2-user

# clear out previous config files
rm ~/.profile
rm ~/.bash_profile
rm ~/.zprofile
rm ~/.zshrc

mv ~/.profile ~/.profile.bak

ln -s ~/.dot/profile.debian ~/.profile
ln -s ~/.dot/zprofile ~/.zprofile
ln -s ~/.dot/zshrc ~/.zshrc
ln -s ~/.dot/oh-my-zsh/ ~/.oh-my-zsh

ln -s ~/.dot/vim/ ~/.vim
ln -s ~/.dot/vimrc ~/.vimrc
ln -s ~/.dot/gvimrc ~/.gvimrc

ln -s ~/.dot/tmux.debian ~/.tmux.conf

ln -s ~/.dot/gitconfig ~/.gitconfig
ln -s ~/.dot/gitignore ~/.gitignore

ln -s ~/.dot/ipython_config.py ~/.ipython/profile_default/ipython_config.py

# add brew to bash
echo 'eval "$(/home/ec2-user/.linuxbrew/bin/brew shellenv)"' >> /home/ec2-user/.bash_profile
eval "$(/home/ec2-user/.linuxbrew/bin/brew shellenv)"

cp -r colors ~/.vim/

# pluginstall vim deps
vim +'PlugInstall --sync' +qa

# set git user to ddl
git config --global user.email "ryuta.oshikiri@dominodatalab.com"
# git config --list

# youcompleteme installation
wget https://cmake.org/files/v3.24/cmake-3.24.1.tar.gz
tar -xvzf cmake-3.24.1.tar.gz
cd cmake-3.24.1
./bootstrap
sudo make
sudo make install

sudo yum install gcc-c++ ncurses-devel python-devel cmake
cd ~/.vim/plugged/YouCompleteMe
git submodule update --init --recursive

CC=gcc-8 CXX=g++-8 python3 ./install.py
